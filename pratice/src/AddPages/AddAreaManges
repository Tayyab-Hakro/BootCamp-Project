import React, { useState } from "react";

const initialFormData = {
  areaName: "Federal B Area",
  areaManager: "Ali Raza",
  branches: [],
  status: "Active",
};

const allBranches = [
  "Gulshan Branch",
  "Zaitoon Ashraf",
  "Clifton",
  "Kharadar Branch",
  "Gizri Branch",
  "DHA",
];

const statusOptions = ["Active", "In Active"];

const AreaManagersForm = () => {
  const [formData, setFormData] = useState(initialFormData);
  const [isBranchesDropdownOpen, setIsBranchesDropdownOpen] = useState(false);
  const [isStatusDropdownOpen, setIsStatusDropdownOpen] = useState(false);

  const handleChange = (e) => {
    const { name, value } = e.target;
    setFormData((prevData) => ({ ...prevData, [name]: value }));
  };

  const handleBranchChange = (branchName) => {
    setFormData((prevData) => {
      const currentBranches = prevData.branches;
      if (currentBranches.includes(branchName)) {
        return { ...prevData, branches: currentBranches.filter((b) => b !== branchName) };
      } else {
        return { ...prevData, branches: [...currentBranches, branchName] };
      }
    });
  };

  const handleStatusChange = (newStatus) => {
    setFormData((prevData) => ({ ...prevData, status: newStatus }));
    setIsStatusDropdownOpen(false);
  };

  const handleSubmit = (e) => {
    e.preventDefault();
    console.log("Area Managers Form Data Submitted:", formData);
    alert("Area Manager Information Saved! Check console for data.");
  };

  const getBranchesDisplay = () => {
    if (formData.branches.length === 0) return "Select Branches";
    return `${formData.branches.length} Selected`;
  };

  return (
    <div className="bg-white p-6 w-[95%] max-w-md mx-auto rounded-lg shadow-2xl">
      <h2 className="text-2xl font-semibold mb-6">Add Area Managers</h2>
      <form onSubmit={handleSubmit} className="space-y-6">
        {/* Area Name */}
        <div>
          <label className="block text-base text-gray-700 mb-1">Area Name</label>
          <input
            type="text"
            name="areaName"
            className="w-full border border-gray-400 p-3 rounded-md focus:ring-0 focus:border-blue-500"
            value={formData.areaName}
            onChange={handleChange}
          />
        </div>

        {/* Area Manager */}
        <div>
          <label className="block text-base text-gray-700 mb-1">Area Manager</label>
          <input
            type="text"
            name="areaManager"
            className="w-full border border-gray-400 p-3 rounded-md focus:ring-0 focus:border-blue-500"
            value={formData.areaManager}
            onChange={handleChange}
          />
        </div>

        {/* Branches Dropdown */}
        <div>
          <label className="block text-base text-gray-700 mb-1">Branches</label>
          <div
            className="w-full border border-gray-400 p-3 rounded-md bg-white cursor-pointer relative"
            onClick={() => setIsBranchesDropdownOpen(!isBranchesDropdownOpen)}
          >
            <div className="flex justify-between items-center text-gray-700">
              {getBranchesDisplay()}
              <svg
                className={`w-4 h-4 transition-transform ${
                  isBranchesDropdownOpen ? "rotate-180" : "rotate-0"
                }`}
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  strokeWidth="2"
                  d="M19 9l-7 7-7-7"
                />
              </svg>
            </div>

            {isBranchesDropdownOpen && (
              <div className="absolute z-10 w-full mt-2 bg-white border border-gray-300 rounded-md shadow-lg top-full left-0 p-2 flex flex-wrap gap-2">
                {allBranches.map((branch) => (
                  <label
                    key={branch}
                    className="flex items-center space-x-2 border border-gray-300 rounded-full px-3 py-1 cursor-pointer select-none hover:bg-gray-50"
                  >
                    <input
                      type="checkbox"
                      checked={formData.branches.includes(branch)}
                      onChange={() => handleBranchChange(branch)}
                      className="form-checkbox text-blue-600 rounded"
                    />
                    <span className="text-sm">{branch.replace(" Branch", "")}</span>
                  </label>
                ))}
              </div>
            )}
          </div>
        </div>

        {/* Status Dropdown */}
        <div>
          <label className="block text-base text-gray-700 mb-1">Status</label>
          <div
            className="w-full border border-gray-400 p-3 rounded-md bg-white cursor-pointer relative"
            onClick={() => setIsStatusDropdownOpen(!isStatusDropdownOpen)}
          >
            <div className="flex justify-between items-center text-gray-700">
              {formData.status}
              <svg
                className={`w-4 h-4 transition-transform ${
                  isStatusDropdownOpen ? "rotate-180" : "rotate-0"
                }`}
                fill="none"
                stroke="currentColor"
                viewBox="0 0 24 24"
              >
                <path
                  strokeLinecap="round"
                  strokeLinejoin="round"
                  strokeWidth="2"
                  d="M19 9l-7 7-7-7"
                />
              </svg>
            </div>

            {isStatusDropdownOpen && (
              <div className="absolute z-10 w-full mt-2 bg-white border border-gray-300 rounded-md shadow-lg top-full left-0">
                {statusOptions.map((option) => (
                  <div
                    key={option}
                    className={`p-3 cursor-pointer hover:bg-gray-100 ${
                      formData.status === option ? "bg-gray-200 font-medium" : ""
                    }`}
                    onClick={(e) => {
                      e.stopPropagation();
                      handleStatusChange(option);
                    }}
                  >
                    {option}
                  </div>
                ))}
              </div>
            )}
          </div>
        </div>

        <button
          type="submit"
          className="w-full mt-8 bg-blue-600 hover:bg-blue-700 text-white py-3 rounded-lg font-bold shadow-md"
        >
          Save
        </button>
      </form>
    </div>
  );
};

export default function App() {
  return (
    <div className="p-4 sm:p-10 flex justify-center items-center min-h-screen bg-gray-100">
      <AreaManagersForm />
    </div>
  );
}
